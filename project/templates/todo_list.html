{%extends 'home.html'%}

{%block body%}
<ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
    <li class="nav-item" role="presentation">
      <a style="text-decoration: none;" href="single_search_person"><button class="nav-link" id="pills-home-tab" data-bs-toggle="pill" data-bs-target="#pills-home" type="button" role="tab" aria-controls="pills-home" aria-selected="true">Single Student Search </button></a>
    </li>
    <li class="nav-item" role="presentation">
      <a style="text-decoration: none;" href="entire_search_person"><button class="nav-link" id="pills-profile-tab" data-bs-toggle="pill" data-bs-target="#pills-profile" type="button" role="tab" aria-controls="pills-profile" aria-selected="false">Course Based Search</button></a>
    </li>
    <li class="nav-item" role="presentation">
        <a style="text-decoration: none;" href="todo_list"><button class="nav-link" id="pills-profile-tab" data-bs-toggle="pill" data-bs-target="#pills-profile" type="button" role="tab" aria-controls="pills-profile" aria-selected="false">Todo list</button></a>
      </li>
  </ul>
<div class="form">
    <center>
        <h2 color="red">To Do List For Poor Students</h2>
    </center>
    <form action="todo_list" method="post">
        {% csrf_token %}
        <center>

            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="floatingInput" placeholder="Rollno" name="rollno">
                <label for="floatingInput">Rollno</label>
            </div>
            <select class="form-select" aria-label="Default select example" name="course">
                {%for i in details_course%}
                <option value="{{i}}">{{i}}</option>
                {%endfor%}
            </select>
            <center><button type="submit" class="btn btn-primary">submit</button></center>
        </center>
    </form>
</div>
<div class="form">
    <h3>{{rollno}} is poor at</h3>
    <table class="table table-hover">
        <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">course</th>
                <th scope="col">status</th>
            </tr>
            <tr>
                <td colspan="3">
                    <div class="progress">
                        <div class="progress-bar" id="progress-bar" value="{{z}}" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                      </div>
                </td>
            </tr>
        </thead>
        <tbody class="table-group-divider">
            {%for psubject,status in poor_student_list.items%}
            <tr>
                <th scope="row">{{forloop.counter}}</th>
                <td>{{psubject}}</td>
                <td>{{status}}</td>
            </tr>
            
            
            <tr>
                <td colspan="3">
                    <table class="table mb-0">
                        <tbody>
                            
                            {%for subject,category in todo_subjects.items%}
                            {%if psubject == subject%}
                            {%with var=category%}
                            {%for k,l in todo_category.items%}
                            {%if k == var%}
                            {%for z in l%}
                            <tr>
                                <td>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="{{z}}">
                                        <label class="form-check-label" for="flexCheckDefault">
                                            {{z}}
                                        </label>
                                    </div>
                                </td>
                            </tr>

                            {%endfor%}
                            {%endif%}
                            {%endfor%}
                            {%endwith%}
                            {%endif%}
                            {{break}}
                            {%endfor%}
                        </tbody>
                        <script>
                            var checkboxes = document.querySelectorAll('input[type=checkbox]');
                            var progressBar = document.getElementById('progress-bar');
                            var totalCheckboxes = checkboxes.length;
                            var checkedCheckboxes = 0;
                            
                            checkboxes.forEach(function(checkbox) {
                              checkbox.addEventListener('change', function() {
                                if (this.checked) {
                                  checkedCheckboxes++;
                                } else {
                                  checkedCheckboxes--;
                                }
                                updateProgress(checkedCheckboxes, totalCheckboxes);
                              });
                            });
                            
                            function updateProgress(checked, total) {
                              var progress = (checked / total) * 100;
                              progressBar.style.width = progress + "%";
                              progressBar.setAttribute("aria-valuenow", progress);
                            }
                          </script>
                        <!-- <tfoot>
                            <div class="progress" role="progressbar" aria-label="Basic example" aria-valuenow="1"
                                aria-valuemin="0" aria-valuemax="1">
                                <div class="progress-bar" style="width: 25%"></div>
                            </div>
                        </tfoot> -->
                    </table>
                </td>
            </tr>
            {%endfor%}

        </tbody>

    </table>
</div>
{%endblock%}